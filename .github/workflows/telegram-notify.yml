name: üí¨ Telegram Notifications

on:
  push:
    branches: [main]

env:
  DOTNET_VERSION: '8.0.x'

jobs:
  build-and-test:
    name: üèóÔ∏è –°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç—ã
    runs-on: ubuntu-latest
    
    steps:
    - name: üì• –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–¥
      uses: actions/checkout@v4
    
    - name: ‚öôÔ∏è –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: ${{ env.DOTNET_VERSION }}
    
    - name: üî® –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ —Å–æ–±–∏—Ä–∞–µ–º
      run: |
        dotnet restore
        dotnet build --configuration Release --no-restore
    
    - name: üß™ –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
      run: dotnet test --verbosity normal
    
    - name: üì¢ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      uses: appleboy/telegram-action@master
      with:
        to: ${{ secrets.TELEGRAM_CHAT_ID }}
        token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        message: |
          ${{ job.status == 'success' && '‚úÖ *–°–ë–û–†–ö–ê –£–°–ü–ï–®–ù–ê!*' || '‚ùå *–°–ë–û–†–ö–ê –ù–ï –£–î–ê–õ–ê–°–¨!*' }}
          
          *–ü—Ä–æ–µ–∫—Ç:* ${{ github.repository }}
          *–í–µ—Ç–∫–∞:* ${{ github.ref_name }}
          *–ö–æ–º–º–∏—Ç:* ${GITHUB_SHA:0:7}
          *–°—Ç–∞—Ç—É—Å:* ${{ job.status }}
          
          [–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }})
        parse_mode: markdown
